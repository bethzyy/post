# è§†é¢‘ä¸‹è½½å·¥å…· - é›†æˆåˆ°å·¥å…·ç®¡ç†å™¨

## ğŸ“… æ›´æ–°æ—¥æœŸ
2026å¹´1æœˆ29æ—¥

## âœ… å·²å®Œæˆçš„å·¥ä½œ

### 1. åˆ›å»ºvideoç›®å½•
```
C:\D\CAIE_tool\MyAIProduct\post\video\
```

### 2. ç§»åŠ¨å·¥å…·åˆ°videoç›®å½•
- **æºæ–‡ä»¶**: `article/baidu_video_downloader_v2.py`
- **ç›®æ ‡æ–‡ä»¶**: `video/baidu_video_downloader.py`

### 3. æ›´æ–°å·¥å…·ç®¡ç†å™¨é…ç½®

#### æ·»åŠ videoåˆ†ç±»
åœ¨ `tool_manager.py` çš„ `categories` å­—å…¸ä¸­æ·»åŠ :
```python
"video": "è§†é¢‘ä¸‹è½½å·¥å…·"
```

#### æ·»åŠ å·¥å…·æè¿°
åœ¨ `TOOL_DESCRIPTIONS` ä¸­æ·»åŠ :
```python
"video/": {
    "baidu_video_downloader.py": {
        "description": "ä¸‹è½½å™¨ - ç™¾åº¦è§†é¢‘ä¸‹è½½å·¥å…· v2.0 (Seleniumå¢å¼ºç‰ˆ,æ”¯æŒç»•è¿‡å®‰å…¨éªŒè¯)",
        "needs_input": True,
        "input_fields": [
            {
                "name": "url",
                "label": "è§†é¢‘URL",
                "type": "text",
                "placeholder": "å¦‚: https://mbd.baidu.com/newspaper/data/videolanding?nid=...",
                "required": True
            },
            {
                "name": "output_filename",
                "label": "è¾“å‡ºæ–‡ä»¶å",
                "type": "text",
                "placeholder": "å¦‚: video.mp4 (ç•™ç©ºè‡ªåŠ¨ç”Ÿæˆ)",
                "required": False
            }
        ]
    },
}
```

#### æ·»åŠ APIè·¯ç”±å¤„ç†
åœ¨ `/api/run` è·¯ç”±ä¸­æ·»åŠ :
```python
elif filename == 'video/baidu_video_downloader.py':
    params = data.get('params', {})
    url = params.get('url', '')
    output_filename = params.get('output_filename', '')

    if not url:
        return jsonify({'success': False, 'error': 'è§†é¢‘URLä¸èƒ½ä¸ºç©º'})

    # åˆ›å»ºä¸´æ—¶è¾“å…¥æ–‡ä»¶
    with tempfile.NamedTemporaryFile(mode='w+', delete=False, suffix='.txt', encoding='utf-8') as f:
        f.write(url + '\n')
        f.write(output_filename + '\n')
        temp_file = f.name

    process = subprocess.Popen(
        ['python', str(tool_path)],
        stdin=open(temp_file, 'r', encoding='utf-8'),
        stdout=subprocess.PIPE,
        stderr=subprocess.PIPE,
        cwd=BASE_DIR,
        env=env
    )
```

### 4. æ›´æ–°Webç•Œé¢

#### å‰ç«¯å‚æ•°æ”¶é›†
åœ¨ `runTool()` å‡½æ•°ä¸­æ·»åŠ :
```javascript
// å¦‚æœæ˜¯ç™¾åº¦è§†é¢‘ä¸‹è½½å™¨,è·å–URLå’Œè¾“å‡ºæ–‡ä»¶å
if (currentTool.filename === 'video/baidu_video_downloader.py') {
    const url = document.getElementById('param-url').value;
    const outputFilename = document.getElementById('param-output_filename').value;

    if (!url) {
        addLog('error', 'è¯·è¾“å…¥è§†é¢‘URL');
        btn.disabled = false;
        btn.textContent = 'â–¶ï¸ è¿è¡Œå·¥å…·';
        btn.classList.remove('running');
        return;
    }

    requestData.params = {
        url: url,
        output_filename: outputFilename
    };
    addLog('info', `è§†é¢‘URL: ${url}`);
    if (outputFilename) {
        addLog('info', `è¾“å‡ºæ–‡ä»¶: ${outputFilename}`);
    } else {
        addLog('info', `è¾“å‡ºæ–‡ä»¶: è‡ªåŠ¨ç”Ÿæˆ`);
    }
}
```

### 5. ä¿®æ”¹å·¥å…·æ”¯æŒstdinè¾“å…¥

åœ¨ `baidu_video_downloader.py` çš„ `main()` å‡½æ•°ä¸­æ·»åŠ :
```python
# æ£€æŸ¥æ˜¯å¦æœ‰æ ‡å‡†è¾“å…¥(ä»Webç•Œé¢è°ƒç”¨)
web_mode = not sys.stdin.isatty()

if web_mode:
    # Webæ¨¡å¼ - ä»ç®¡é“è¯»å–å‚æ•°
    url = sys.stdin.readline().strip()
    output_filename = sys.stdin.readline().strip()

    # å¤„ç†ä¸‹è½½...
```

## ğŸ¯ ä½¿ç”¨æ–¹æ³•

### Webç•Œé¢ä½¿ç”¨

1. **æ‰“å¼€å·¥å…·ç®¡ç†å™¨**
   ```
   è®¿é—®: http://localhost:5000
   ```

2. **é€‰æ‹©å·¥å…·**
   ```
   å·¦ä¾§å¯¼èˆªæ ‘ â†’ è§†é¢‘ä¸‹è½½å·¥å…· â†’ baidu_video_downloader.py
   ```

3. **è¾“å…¥å‚æ•°**
   ```
   è§†é¢‘URL: https://mbd.baidu.com/newspaper/data/videolanding?nid=...
   è¾“å‡ºæ–‡ä»¶å: video.mp4 (æˆ–ç•™ç©ºè‡ªåŠ¨ç”Ÿæˆ)
   ```

4. **è¿è¡Œå·¥å…·**
   ```
   ç‚¹å‡»"â–¶ï¸ è¿è¡Œå·¥å…·"æŒ‰é’®
   ```

5. **æŸ¥çœ‹æ—¥å¿—**
   ```
   å³ä¾§æ—¥å¿—é¢æ¿ä¼šæ˜¾ç¤º:
   [Webæ¨¡å¼] URL: ...
   [Webæ¨¡å¼] è¾“å‡ºæ–‡ä»¶: ...
   [Selenium] æ­£åœ¨å¯åŠ¨æµè§ˆå™¨...
   [ä¸‹è½½] å¼€å§‹ä¸‹è½½è§†é¢‘...
   [è¿›åº¦] 100%
   [æˆåŠŸ] è§†é¢‘ä¸‹è½½å®Œæˆ!
   ```

### å‘½ä»¤è¡Œä½¿ç”¨

```bash
cd C:\D\CAIE_tool\MyAIProduct\post\video

# åŸºæœ¬ç”¨æ³•
python baidu_video_downloader.py

# æŒ‡å®šURLå’Œæ–‡ä»¶å
python baidu_video_downloader.py "è§†é¢‘URL" "output.mp4"
```

## ğŸ“Š å·¥å…·ç‰¹ç‚¹

### Webç•Œé¢é›†æˆ
- âœ… å‚æ•°è¾“å…¥è¡¨å•
- âœ… å®æ—¶æ—¥å¿—è¾“å‡º
- âœ… è¿›åº¦è·Ÿè¸ª
- âœ… é”™è¯¯æç¤º

### åŠŸèƒ½ç‰¹ç‚¹
- âœ… Seleniumè‡ªåŠ¨åŒ–
- âœ… ç»•è¿‡å®‰å…¨éªŒè¯
- âœ… æ”¯æŒå¤šç§è§†é¢‘æ ¼å¼
- âœ… è‡ªåŠ¨æ–‡ä»¶å‘½å
- âœ… ä¸‹è½½è¿›åº¦æ˜¾ç¤º

## ğŸ”§ æŠ€æœ¯å®ç°

### å‚æ•°ä¼ é€’æµç¨‹
```
ç”¨æˆ·è¾“å…¥å‚æ•°
    â†“
JavaScriptæ”¶é›† (runTool)
    â†“
fetch POST /api/run
    â†“
Flaskæ¥æ”¶å‚æ•°
    â†“
åˆ›å»ºä¸´æ—¶æ–‡ä»¶
    â†“
subprocess + stdin
    â†“
Pythonè„šæœ¬è¯»å–
    â†“
Seleniumä¸‹è½½è§†é¢‘
```

### æ–‡ä»¶ç»“æ„
```
video/
â”œâ”€â”€ baidu_video_downloader.py  # ä¸»å·¥å…·
â””â”€â”€ (è§†é¢‘ä¸‹è½½åˆ°è¿™é‡Œ)
```

## ğŸ’¡ æ³¨æ„äº‹é¡¹

### Seleniumä¾èµ–
å¦‚æœæœªå®‰è£…Selenium,å·¥å…·ä¼šè‡ªåŠ¨ä½¿ç”¨åŸºç¡€æ¨¡å¼:
- åŸºç¡€æ¨¡å¼å¯èƒ½æ— æ³•ç»•è¿‡å®‰å…¨éªŒè¯
- å»ºè®®å®‰è£…Seleniumä»¥è·å¾—æœ€ä½³ä½“éªŒ

å®‰è£…Selenium:
```bash
pip install selenium
```

å®‰è£…ChromeDriver:
- ä¸‹è½½: https://chromedriver.chromium.org/downloads
- æ”¾åˆ°Python Scriptsç›®å½•

### è§†é¢‘URLæœ‰æ•ˆæ€§
- ç¡®ä¿URLå¯ä»¥æ­£å¸¸è®¿é—®
- è§†é¢‘å¯èƒ½å·²è¢«åˆ é™¤æˆ–è®¾ä¸ºç§å¯†
- å·¥å…·ä¼šæ˜¾ç¤ºè¯¦ç»†çš„é”™è¯¯ä¿¡æ¯

## ğŸ“ ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹1: ä¸‹è½½ç™¾åº¦æ–°é—»è§†é¢‘
```
URL: https://mbd.baidu.com/newspaper/data/videolanding?nid=sv_4044622135715273707&sourceFrom=qmj
æ–‡ä»¶å: news_video.mp4
```

### ç¤ºä¾‹2: è‡ªåŠ¨å‘½å
```
URL: https://mbd.baidu.com/...
æ–‡ä»¶å: (ç•™ç©º)
ç»“æœ: baidu_video_1738172345.mp4
```

## ğŸ‰ æ€»ç»“

ç™¾åº¦è§†é¢‘ä¸‹è½½å·¥å…·å·²æˆåŠŸé›†æˆåˆ°å·¥å…·ç®¡ç†å™¨:
- âœ… åˆ›å»ºäº†videoç›®å½•
- âœ… ç§»åŠ¨å¹¶æ›´æ–°äº†å·¥å…·
- âœ… æ·»åŠ äº†å·¥å…·é…ç½®
- âœ… æ›´æ–°äº†APIè·¯ç”±
- âœ… æ›´æ–°äº†Webç•Œé¢
- âœ… æ”¯æŒstdinå‚æ•°è¾“å…¥

ç°åœ¨å¯ä»¥é€šè¿‡Webç•Œé¢æ–¹ä¾¿åœ°ä¸‹è½½ç™¾åº¦è§†é¢‘! ğŸš€

---

**ç‰ˆæœ¬**: v2.0
**æ›´æ–°æ—¥æœŸ**: 2026-01-29
**ä½œè€…**: AIå‘æ–‡å·¥å…·ç®¡ç†å™¨
