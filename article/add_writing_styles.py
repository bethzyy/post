# -*- coding: utf-8 -*-
"""
为今日头条文章生成器添加更多写作风格
"""
import re

# 读取文件
with open('toutiao_article_generator.py', 'r', encoding='utf-8') as f:
    content = f.read()

# 找到 generate_article_with_ai 函数中的风格判断部分
old_style_check = '''        # 根据风格选择不同的prompt
        if style == 'wangzengqi':
            prompt = f"""你是汪曾祺先生，中国当代著名作家。请用你的散文风格写一篇关于"{theme}"的文章。

## 汪曾祺散文风格特点：
1. **语言特点**：
   - 简洁平淡，朴实有趣
   - 平易自然，富有节奏感
   - 不用华丽辞藻，但意味深长
   - 口语化，有生活气息

2. **结构特点**：
   - 形散神聚，看似随意实则精心
   - 从小事写起，以小见大
   - 漫不经心中见真意

3. **情感特点**：
   - 淡雅怀旧，有温度
   - 乐观平和的人生态度
   - 关注日常人事，体察细微

4. **禁忌**：
   - 不得使用"首先、其次、最后"等公文式表达
   - 不得过度使用emoji
   - 不得使用营销话术（"让我们一起"、"不容错过"等）
   - 不得生硬列举"5个XX"、"3大XX"

## 用户草稿中的情感基调（请保留并发挥）：
"每次走进图书馆，那种特有的静谧和书香气息总能让我心神安宁..."
"我想象中的未来图书馆，绝不仅仅是数字化升级后的'智能书库'。它应该是一座城市的'第三空间'——不是家，不是办公室，而是属于心灵的栖息地。"

## 写作要求：
1. 字数: {target_length}字左右
2. 主题: {theme}
3. 开头: 从个人经历或感受写起（比如走进图书馆的那份安宁）
4. 内容:
   - 谈谈2026年AI时代的图书馆变化
   - 保留原草稿中"第三空间"、"心灵栖息地"等核心概念
   - 用平淡朴实的语言写深刻的思想
5. 结尾: 留有余韵，引人思考
6. 标题: 简洁有意境，15-25字

请直接输出文章内容,格式如下:

---
标题: [文章标题]

[正文内容]

---

记住:你要写的是一篇有温度、有情怀的散文，而不是营销文案。语言要平淡但有力，朴实但深刻。
"""
        else:'''

new_style_check = '''        # 根据风格选择不同的prompt
        if style == 'luxun':
            prompt = f"""你是鲁迅先生，中国现代文学奠基人。请用你的杂文风格写一篇关于"{theme}"的文章。

## 鲁迅杂文风格特点：
1. **语言特点**：
   - 简洁锋利，一针见血
   - 冷峻深刻，辛辣讽刺
   - 用词精准，逻辑严密
   - 善用反语和讽刺

2. **结构特点**：
   - 开门见山，直击要害
   - 层层递进，论证严密
   - 善用对比，揭露矛盾

3. **思想特点**：
   - 批判精神，直面社会现实
   - 深刻洞察，揭示本质
   - 忧国忧民，悲天悯人

4. **禁忌**：
   - 不得使用空洞的口号
   - 不得滥用感叹号
   - 不得使用营销话术
   - 不得使用emoji

## 写作要求：
1. 字数: {target_length}字左右
2. 主题: {theme}
3. 开头: 直接切入主题，观点鲜明
4. 内容:
   - 深入分析现象背后的本质
   - 批判时弊，引人深思
   - 用事实和逻辑说话
5. 结尾: 发人深省，留有余味
6. 标题: 简洁有力，体现思想深度

请直接输出文章内容,格式如下:

---
标题: [文章标题]

[正文内容]

---

记住:你要写的是一篇有思想深度的杂文，要敢于批评，善于批判，用文字唤醒读者。
"""
        elif style == 'wangzengqi':
            prompt = f"""你是汪曾祺先生，中国当代著名作家。请用你的散文风格写一篇关于"{theme}"的文章。

## 汪曾祺散文风格特点：
1. **语言特点**：
   - 简洁平淡，朴实有趣
   - 平易自然，富有节奏感
   - 不用华丽辞藻，但意味深长
   - 口语化，有生活气息

2. **结构特点**：
   - 形散神聚，看似随意实则精心
   - 从小事写起，以小见大
   - 漫不经心中见真意

3. **情感特点**：
   - 淡雅怀旧，有温度
   - 乐观平和的人生态度
   - 关注日常人事，体察细微

4. **禁忌**：
   - 不得使用"首先、其次、最后"等公文式表达
   - 不得过度使用emoji
   - 不得使用营销话术（"让我们一起"、"不容错过"等）
   - 不得生硬列举"5个XX"、"3大XX"

## 写作要求：
1. 字数: {target_length}字左右
2. 主题: {theme}
3. 开头: 从个人经历或感受写起
4. 内容:
   - 从日常小事中发掘深意
   - 用平淡朴实的语言写深刻的思想
   - 关注人情冷暖，生活细节
5. 结尾: 留有余韵，引人思考
6. 标题: 简洁有意境，15-25字

请直接输出文章内容,格式如下:

---
标题: [文章标题]

[正文内容]

---

记住:你要写的是一篇有温度、有情怀的散文，而不是营销文案。语言要平淡但有力，朴实但深刻。
"""
        elif style == 'gentle':
            prompt = f"""请用温柔婉约的笔触写一篇关于"{theme}"的文章。

## 温柔婉约风格特点：
1. **语言特点**：
   - 轻柔细腻，温婉动人
   - 善用比喻和意象
   - 节奏舒缓，如诉家常
   - 充满女性化柔情

2. **情感特点**：
   - 温暖治愈，抚慰人心
   - 感性细腻，富有诗意
   - 关注情感和内心体验
   - 充满爱和包容

3. **结构特点**：
   - 娓娓道来，不急不躁
   - 情感递进，自然流露
   - 善用细节打动人心

## 写作要求：
1. 字数: {target_length}字左右
2. 主题: {theme}
3. 开头: 用温柔的笔触引入，如春风拂面
4. 内容:
   - 多用温暖治愈的比喻
   - 关注情感共鸣和心理抚慰
   - 适当使用柔和的emoji（如🌸、💕、🌿）
5. 结尾: 温暖收束，给人力量
6. 标题: 温柔唯美，富有诗意

请直接输出文章内容,格式如下:

---
标题: [文章标题]

[正文内容]

---

记住:你要写的是一篇温暖治愈的文章，用温柔的文字抚慰读者的心灵。
"""
        elif style == 'sharp':
            prompt = f"""请用简洁锋利的笔触写一篇关于"{theme}"的文章。

## 简洁锋利风格特点：
1. **语言特点**：
   - 短句为主，节奏明快
   - 用词精准，一语中的
   - 逻辑清晰，论证严密
   - 不拖泥带水

2. **思想特点**：
   - 观点鲜明，直击要害
   - 分析透彻，深入浅出
   - 理性客观，不说教
   - 用数据和事实说话

3. **结构特点**：
   - 开门见山，不绕弯子
   - 层次分明，条理清晰
   - 结论明确，掷地有声

## 写作要求：
1. 字数: {target_length}字左右
2. 主题: {theme}
3. 开头: 直接点明主题，一句话抓住读者
4. 内容:
   - 用数据和案例支撑观点
   - 逻辑严密，层层递进
   - 避免冗长的修饰和铺垫
5. 结尾: 简洁有力，观点明确
6. 标题: 简洁明了，直击要点

请直接输出文章内容,格式如下:

---
标题: [文章标题]

[正文内容]

---

记住:你要写的是一篇简洁有力的文章，用最少的文字传达最有价值的信息，观点犀利，论证严密。
"""
        else:'''

if old_style_check in content:
    content = content.replace(old_style_check, new_style_check)
    print("OK: 已添加新文风选项")
else:
    print("ERROR: 未找到目标代码")
    exit(1)

# 更新函数文档字符串
old_docstring = """        """使用AI生成文章

        Args:
            theme: 文章主题
            target_length: 目标字数
            style: 写作风格 ('standard' 标准风格, 'wangzengqi' 汪曾祺风格)
        \"\"\"\n\n        print(f"\\n[AI生成] 正在为主题'{theme}'生成文章...")
        print(f"[AI生成] 目标字数: {target_length}字")
        print(f"[AI生成] 风格: {{'汪曾祺' if style == 'wangzengqi' else '标准'}}\\n")"""

new_docstring = '''        """使用AI生成文章

        Args:
            theme: 文章主题
            target_length: 目标字数
            style: 写作风格
                - 'standard': 标准风格 (通俗易懂,接地气)
                - 'luxun': 鲁迅风格 (简洁锋利,批判深刻)
                - 'wangzengqi': 汪曾祺风格 (淡雅质朴,形散神聚)
                - 'gentle': 温柔婉约 (温暖治愈,细腻感性)
                - 'sharp': 简洁锋利 (逻辑严密,观点鲜明)
        \"\"\\"\n\n        print(f"\\n[AI生成] 正在为主题'{theme}'生成文章...")
        print(f"[AI生成] 目标字数: {target_length}字")
        \n        # 风格名称映射\n        style_names = {\n            'standard': '标准',\n            'luxun': '鲁迅',\n            'wangzengqi': '汪曾祺',\n            'gentle': '温柔婉约',\n            'sharp': '简洁锋利'\n        }\n        style_name = style_names.get(style, '标准')\n        print(f"[AI生成] 风格: {{style_name}}\\n")'''

if old_docstring in content:
    content = content.replace(old_docstring, new_docstring)
    print("OK: 已更新函数文档")
else:
    print("WARNING: 未找到函数文档字符串")

# 写回文件
with open('toutiao_article_generator.py', 'w', encoding='utf-8') as f:
    f.write(content)

print("完成! 已添加5种写作风格")
